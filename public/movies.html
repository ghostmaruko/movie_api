<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Movie List</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .movie-card {
        display: inline-block;
        margin: 10px;
        width: 200px;
        text-align: center;
      }
      .movie-card img {
        width: 100%;
        cursor: pointer;
      }
      #popup {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #fff;
        padding: 20px;
        border: 1px solid #333;
        z-index: 100;
      }
      #popup button {
        margin-top: 10px;
      }
      #overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 50;
      }
    </style>
  </head>
  <body>
    <h1>Movie List</h1>
    <div id="movies-container"></div>

    <div id="overlay"></div>
    <div id="popup">
      <h2 id="popupTitle"></h2>
      <p id="popupDescription"></p>
      <p><strong>Genre:</strong> <span id="popupGenre"></span></p>
      <p><strong>Director:</strong> <span id="popupDirector"></span></p>
      <p><strong>Year:</strong> <span id="popupYear"></span></p>
      <p><strong>Actors:</strong> <span id="popupActors"></span></p>
      <button id="closePopup">Close</button>
    </div>

    <script>
      const container = document.getElementById("movies-container");
      const popup = document.getElementById("popup");
      const overlay = document.getElementById("overlay");

      const popupTitle = document.getElementById("popupTitle");
      const popupDescription = document.getElementById("popupDescription");
      const popupGenre = document.getElementById("popupGenre");
      const popupDirector = document.getElementById("popupDirector");
      const popupYear = document.getElementById("popupYear");
      const popupActors = document.getElementById("popupActors");
      const closePopup = document.getElementById("closePopup");

      fetch("/movies")
        .then((res) => res.json())
        .then((movies) => {
          movies.forEach((movie) => {
            console.log(movie); // controlla i campi
            const card = document.createElement("div");
            card.className = "movie-card";

            const img = document.createElement("img");
            img.src = movie.ImagePath || "/img/placeholder.jpg";
            img.alt = movie.Title;
            img.addEventListener("click", () => showPopup(movie));

            const title = document.createElement("p");
            title.textContent = movie.Title;

            card.appendChild(img);
            card.appendChild(title);
            container.appendChild(card);
          });
        })
        .catch((err) => console.error(err));

      function showPopup(movie) {
        popupTitle.textContent = movie.Title || "N/A";
        popupDescription.textContent = movie.Description || "N/A";
        popupGenre.textContent = movie.Genre?.Name || "N/A";
        popupDirector.textContent = movie.Director?.Name || "N/A";
        popupYear.textContent = movie.Year || "N/A";
        popupActors.textContent = movie.Actors?.join(", ") || "N/A";

        popup.style.display = "block";
        overlay.style.display = "block";
      }

      closePopup.addEventListener("click", () => {
        popup.style.display = "none";
        overlay.style.display = "none";
      });

      overlay.addEventListener("click", () => {
        popup.style.display = "none";
        overlay.style.display = "none";
      });
    </script>
  </body>
</html>
